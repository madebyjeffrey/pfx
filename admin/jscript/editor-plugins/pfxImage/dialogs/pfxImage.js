(function(){var k=function(c,f){function l(){var b=arguments,a=this.getContentElement("advanced","txtdlgGenStyle");a&&a.commit.apply(a,b);this.foreach(function(d){d.commit&&d.id!="txtdlgGenStyle"&&d.commit.apply(d,b)})}var i=/^\s*(\d+)((px)|\%)?\s*$/i,h=function(){var b=this.originalElement;b.setCustomData("isReady","true");b.removeListener("load",h);b.removeListener("error",g);b.removeListener("abort",g);if(this.firstLoad)this.firstLoad=false},g=function(){var b=this.originalElement;b.removeListener("load",
h);b.removeListener("error",g);b.removeListener("abort",g)};return{title:f=="pfxImage"?c.lang.image.title:c.lang.image.titleButton,minWidth:420,minHeight:310,onShow:function(){this.linkEditMode=this.pfxImageEditMode=this.linkElement=this.pfxImageElement=false;this.firstLoad=this.lockRatio=true;this.addLink=false;var b=this.getParentEditor(),a=this.getParentEditor().getSelection().getSelectedElement(),d=a&&a.getAscendant("a");this.originalElement=b.document.createElement("img");this.originalElement.setAttribute("alt",
"");this.originalElement.setCustomData("isReady","false");if(d){this.linkElement=d;this.linkEditMode=true;var e=d.getChildren();if(e.count()==1){var j=e.getItem(0).getName();if(j=="img"||j=="input"){this.pfxImageElement=e.getItem(0);if(this.pfxImageElement.getName()=="img")this.pfxImageEditMode="img";else if(this.pfxImageElement.getName()=="input")this.pfxImageEditMode="input"}}f=="pfxImage"&&this.setupContent(2,d)}if(a&&a.getName()=="img"&&!a.getAttribute("_cke_realelement")||a&&a.getName()=="input"&&
a.getAttribute("type")=="pfxImage"){this.pfxImageEditMode=a.getName();this.pfxImageElement=a}if(this.pfxImageEditMode){this.cleanpfxImageElement=this.pfxImageElement;this.pfxImageElement=this.cleanpfxImageElement.clone(true,true);this.setupContent(1,this.pfxImageElement)}else this.pfxImageElement=b.document.createElement("img")},onOk:function(){if(this.pfxImageEditMode){var b=this.pfxImageEditMode;if(f=="pfxImage"&&b=="input"&&confirm(c.lang.image.button2Img)){this.pfxImageElement=c.document.createElement("img");
this.pfxImageElement.setAttribute("alt","");c.insertElement(this.pfxImageElement)}else if(f!="pfxImage"&&b=="img"&&confirm(c.lang.image.img2Button)){this.pfxImageElement=c.document.createElement("input");this.pfxImageElement.setAttributes({type:"pfxImage",alt:""});c.insertElement(this.pfxImageElement)}else{this.pfxImageElement=this.cleanpfxImageElement;delete this.cleanpfxImageElement}}else{if(f=="pfxImage")this.pfxImageElement=c.document.createElement("img");else{this.pfxImageElement=c.document.createElement("input");
this.pfxImageElement.setAttribute("type","pfxImage")}this.pfxImageElement.setAttribute("alt","")}if(!this.linkEditMode)this.linkElement=c.document.createElement("a");this.commitContent(1,this.pfxImageElement);this.commitContent(2,this.linkElement);this.pfxImageElement.getAttribute("style")||this.pfxImageElement.removeAttribute("style");if(this.pfxImageEditMode)if(!this.linkEditMode&&this.addLink){c.insertElement(this.linkElement);this.pfxImageElement.appendTo(this.linkElement)}else{if(this.linkEditMode&&
!this.addLink){c.getSelection().selectElement(this.linkElement);c.insertElement(this.pfxImageElement)}}else if(this.addLink)if(this.linkEditMode)c.insertElement(this.pfxImageElement);else{c.insertElement(this.linkElement);this.linkElement.append(this.pfxImageElement,false)}else c.insertElement(this.pfxImageElement)},onLoad:function(){f!="pfxImage"&&this.hidePage("Link");this._.element.getDocument();this.commitContent=l},onHide:function(){if(this.originalElement){this.originalElement.removeListener("load",
h);this.originalElement.removeListener("error",g);this.originalElement.removeListener("abort",g);this.originalElement.remove();this.originalElement=false}delete this.pfxImageElement},contents:[{id:"info",label:c.lang.image.infoTab,accessKey:"I",elements:[{type:"vbox",padding:0,children:[{type:"hbox",align:"right",children:[{id:"txtUrl",type:"text",label:c.lang.common.url,required:true,onChange:function(){var b=this.getDialog();if(this.getValue().length>0){b=this.getDialog();b.originalElement.setCustomData("isReady",
"false")}},setup:function(b,a){if(b==1){this.setValue(a.getAttribute("_cke_saved_src")||a.getAttribute("src"));this.setInitValue();this.focus()}},commit:function(b,a){if(b==1&&(this.getValue()||this.isChanged())){a.setAttribute("_cke_saved_src",decodeURI(this.getValue()));a.setAttribute("src",decodeURI(this.getValue()))}else if(b==8){a.setAttribute("src","");a.removeAttribute("src")}},validate:CKEDITOR.dialog.validate.notEmpty(c.lang.image.urlMissing)}]}]},{type:"button",id:"browse",align:"center",
label:c.lang.common.browseServer,hidden:true,filebrowser:"info:txtUrl"},{id:"txtAlt",type:"text",label:c.lang.image.alt,accessKey:"T","default":"Image",setup:function(b,a){b==1&&this.setValue(a.getAttribute("alt"))},commit:function(b,a){if(b==1){if(this.getValue()||this.isChanged())a.setAttribute("alt",this.getValue())}else b==8&&a.removeAttribute("alt")}}]},{id:"Link",label:c.lang.link.title,padding:0,elements:[{id:"txtUrl",type:"text",label:c.lang.common.url,style:"width: 100%","default":"",setup:function(b,
a){if(b==2){var d=a.getAttribute("_cke_saved_href");d||(d=a.getAttribute("href"));this.setValue(d)}},commit:function(b,a){if(b==2)if(this.getValue()||this.isChanged()){a.setAttribute("_cke_saved_href",decodeURI(this.getValue()));a.setAttribute("href","javascript:void(0)/*"+CKEDITOR.tools.getNextNumber()+"*/");if(this.getValue()||!c.config.pfxImage_removeLinkByEmptyURL)this.getDialog().addLink=true}}},{type:"button",id:"browse",filebrowser:{action:"Browse",target:"Link:txtUrl",url:undefined!==c.config.filebrowserImageBrowseLinkUrl?
c.config.filebrowserImageBrowseLinkUrl:c.config.filebrowserBrowseUrl||c.config.filebrowserImageBrowseUrl},hidden:true,label:c.lang.common.browseServer},{id:"cmbTarget",type:"select",label:c.lang.common.target,"default":"",items:[[c.lang.common.notSet,""],[c.lang.common.targetNew,"_blank"],[c.lang.common.targetTop,"_top"],[c.lang.common.targetSelf,"_self"],[c.lang.common.targetParent,"_parent"]],setup:function(b,a){b==2&&this.setValue(a.getAttribute("target"))},commit:function(b,a){if(b==2)if(this.getValue()||
this.isChanged())a.setAttribute("target",this.getValue())}}]},{id:"Upload",hidden:true,filebrowser:"uploadButton",label:c.lang.image.upload,elements:[{type:"file",id:"upload",label:c.lang.image.btnUpload,style:"height:40px",size:38},{type:"fileButton",id:"uploadButton",filebrowser:"info:txtUrl",label:c.lang.image.btnUpload,"for":["Upload","upload"]}]},{id:"advanced",label:c.lang.common.advancedTab,elements:[{type:"hbox",children:[{type:"text",id:"linkId",label:c.lang.common.id,setup:function(b,a){b==
1&&this.setValue(a.getAttribute("id"))},commit:function(b,a){if(b==1)if(this.getValue()||this.isChanged())a.setAttribute("id",this.getValue())}},{type:"text",id:"txtLangCode",label:c.lang.common.langCode,"default":"",setup:function(b,a){b==1&&this.setValue(a.getAttribute("lang"))},commit:function(b,a){if(b==1)if(this.getValue()||this.isChanged())a.setAttribute("lang",this.getValue())}}]},{type:"text",id:"txtGenLongDescr",label:c.lang.common.longDescr,setup:function(b,a){b==1&&this.setValue(a.getAttribute("longDesc"))},
commit:function(b,a){if(b==1)if(this.getValue()||this.isChanged())a.setAttribute("longDesc",this.getValue())}},{type:"hbox",widths:["50%","50%"],children:[{type:"text",id:"txtGenClass",label:c.lang.common.cssClass,"default":editorImageClass,setup:function(b,a){b==1&&this.setValue(a.getAttribute("class"))},commit:function(b,a){if(b==1)if(this.getValue()||this.isChanged())a.setAttribute("class",this.getValue())}},{type:"text",id:"txtGenTitle",label:c.lang.common.advisoryTitle,"default":"",setup:function(b,
a){b==1&&this.setValue(a.getAttribute("title"))},commit:function(b,a){if(b==1){if(this.getValue()||this.isChanged())a.setAttribute("title",this.getValue())}else b==8&&a.removeAttribute("title")}}]},{type:"text",id:"txtdlgGenStyle",label:c.lang.common.cssStyle,"default":"",setup:function(b,a){if(b==1){var d=a.getAttribute("style");if(!d&&a.$.style.cssText)d=a.$.style.cssText;this.setValue(d);var e=a.$.style.height;d=a.$.style.width;e=(e?e:"").match(i);d=(d?d:"").match(i);this.attributesInStyle={height:!!e,
width:!!d}}},commit:function(b,a){if(b==1&&(this.getValue()||this.isChanged()))a.setAttribute("style",this.getValue())}}]}]}};CKEDITOR.dialog.add("pfxImage",function(c){return k(c,"pfxImage")});CKEDITOR.dialog.add("pfxImagebutton",function(c){return k(c,"pfxImagebutton")})})();